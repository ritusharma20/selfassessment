<!-- <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Patna Municipal Corporation - Property Details</title>
<style>
body {
  font-family: "Times New Roman", serif;
  margin: 0;
  background: #fff;
  color: #000;
}
.header {
  display: flex;
  align-items: center;
  border-bottom: 2px solid #000;
  padding: 10px 20px;
}
.header img { width: 70px; margin-right: 15px; }
.header h2 { margin: 0; font-size: 20px; }
.header h3 { margin: 0; font-size: 18px; font-weight: normal; }
.container { padding: 20px 30px; }
.title { font-size: 20px; font-weight: bold; margin-bottom: 15px; }
.details { width: 100%; border-collapse: collapse; }
.details td { padding: 8px 10px; vertical-align: top; }
.label { width: 30%; font-weight: bold; }
.value { width: 20%; }
.footer { margin-top: 40px; padding: 10px; text-align: right; font-size: 13px; border-top: 1px solid #000; }
</style>
</head>
<body>

<!-- HEADER -->
<!-- <div class="header">
  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3a/Emblem_of_Bihar.svg/1200px-Emblem_of_Bihar.svg.png">
  <div>
    <h2>Patna Municipal Corporation</h2>
    <h3>पटना नगर निगम</h3>
  </div>
</div> -->

<!-- CONTENT -->
<!-- <div class="container">
  <div class="title">Property Details</div>

  <table class="details">
    <tr>
      <td class="label">SAS No.:</td><td class="value"><label id="appNoLabel"></label></td>
      <td class="label">Circle:</td><td class="value"><label id="circleLabel"></label></td>
    </tr>
    <tr>
      <td class="label">Year of Assessment:</td><td class="value"><label id="assessmentYearLabel"></label></td>
      <td class="label">Property Type:</td><td class="value"><label id="propertyTypeLabel"></label></td>
    </tr>
    <tr>
      <td class="label">Ward:</td><td class="value"><label id="wardLabel"></label></td>
      <td class="label">Road on which Located:</td><td class="value"><label id="roadLabel"></label></td>
    </tr>
    <tr>
      <td class="label">Road Category:</td><td class="value"><label id="roadCategoryLabel"></label></td>
      <td class="label">Built-up Area (Sq. Ft.):</td><td class="value"><label id="builtUpAreaLabel"></label></td>
    </tr>
    <tr>
      <td class="label">Area of Plot / Land (Sq. Ft.):</td><td class="value"><label id="plotAreaLabel"></label></td>
      <td class="label">Rain Water Harvesting:</td><td class="value"><label id="rainWaterLabel"></label></td>
    </tr>
    <tr>
      <td class="label">Acquisition Date:</td><td class="value"><label id="acquisitionDateLabel"></label></td>
      <td class="label">Mobile No:</td><td class="value"><label id="mobileLabel"></label></td>
    </tr>
    <tr>
      <td class="label">Email:</td><td class="value"><label id="emailLabel"></label></td>
      <td class="label">Ownership Type:</td><td class="value"><label id="otypeLabel"></label></td>
    </tr>
    <tr>
      <td class="label">Water Connection:</td><td class="value"><label id="waterConnectionLabel"></label></td>
      <td class="label">Water Tax Type:</td><td class="value"><label id="waterTaxTypeLabel"></label></td>
    </tr>
    <tr>
      <td class="label">Property Address:</td><td class="value"><label id="propertyAddressLabel"></label></td>
      <td class="label">Property Pin:</td><td class="value"><label id="propertyPinLabel"></label></td>
    </tr>
    <tr>
      <td class="label">Correspondence Address:</td><td class="value"><label id="correspondenceAddressLabel"></label></td>
      <td class="label">Correspondence Pin:</td><td class="value"><label id="correspondencePinLabel"></label></td>
    </tr>
    <tr>
      <td class="label">Owners:</td><td class="value" colspan="3"><div id="ownersLabel"></div></td>
    </tr>
    <tr>
      <td class="label">Documents:</td><td class="value" colspan="3"><div id="documentsLabel"></div></td>
    </tr>
  </table>
</div> -->

<!-- FOOTER -->
<!-- <div class="footer">
  Developed & Maintained By PMU (IT), PMC
</div>

 JS -->
<!-- <script>
async function loadProperty() {
  try {
    const res = await fetch("http://localhost:3000/api/property-details/latest");
    const json = await res.json();
    if (!json.success) return alert(json.message || "No data found");

    const p = json.data; --> 

    <!-- // Fill table with values
    document.getElementById("appNoLabel").innerText = p.Application_No || "";
    document.getElementById("circleLabel").innerText = p.circle || "";
    document.getElementById("wardLabel").innerText = p.ward || "";
    document.getElementById("roadLabel").innerText = p.road || "";
    document.getElementById("roadCategoryLabel").innerText = p.roadCategory || "";
    document.getElementById("builtUpAreaLabel").innerText = p.builtUpArea || "";
    document.getElementById("plotAreaLabel").innerText = p.plotArea || "";
    document.getElementById("rainWaterLabel").innerText = p.rainWater || "";
    document.getElementById("acquisitionDateLabel").innerText = p.acquisitionDate || "";
    document.getElementById("mobileLabel").innerText = p.mobile || "";
    document.getElementById("emailLabel").innerText = p.email || "";
    document.getElementById("otypeLabel").innerText = p.ownershipType || "";
    document.getElementById("waterConnectionLabel").innerText = p.waterConnection || "";
    document.getElementById("waterTaxTypeLabel").innerText = p.waterTaxType || "";
    document.getElementById("propertyAddressLabel").innerText = p.propertyAddress || "";
    document.getElementById("propertyPinLabel").innerText = p.propertyPin || "";
    document.getElementById("correspondenceAddressLabel").innerText = p.correspondenceAddress || "";
    document.getElementById("correspondencePinLabel").innerText = p.correspondencePin || "";

    // Owners
    const ownersContainer = document.getElementById("ownersLabel");
    ownersContainer.innerHTML = "";
    p.owners.forEach((o, i) => {
      const div = document.createElement("div");
      div.textContent = `${i+1}. ${o.name} (CA: ${o.electricityCANo})`;
      ownersContainer.appendChild(div);
    });

    // Documents
    const docsContainer = document.getElementById("documentsLabel");
    docsContainer.innerHTML = "";
    const docs = [];
    if (p.documents.registryPaper) docs.push("Registry Paper");
    if (p.documents.electricityBill) docs.push("Electricity Bill");
    if (p.documents.buildingPhoto) docs.push("Building Photo");
    docs.forEach(d => {
      const div = document.createElement("div");
      div.textContent = d;
      docsContainer.appendChild(div);
    });

  } catch (err) {
    console.error(err);
    alert("Error fetching property data");
  }
}

window.onload = loadProperty;
</script>

</body>
</html> --> 
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Patna Municipal Corporation - Property Details</title>
<style>
body {
  font-family: "Times New Roman", serif;
  margin: 0;
  background: #fff;
  color: #000;
}
.header {
      width: 95%;
      padding: 10px;
      margin-inline: 10px;
      background: #fff;
      box-shadow: 0px 2px 10px #00000033;
      position: fixed;
      top: 0;
      z-index: 1000;
    }

    #imgLogo {
      max-height: 50px;
      width: auto;
      max-width: 100%;
    }
    /* .formBody {
      padding-left: 5vh;
    } */

    :after,
    :before {
      box-sizing: border-box;
    }

    #dvContent {
      width: 95%;
      margin: 0 auto;
      background: linear-gradient(247deg, #F6F8FD 0%, #FFFAF5 100%);
      border-radius: 26px;
      position: relative;
      top: auto;
      margin-top: 100px;
      max-height: calc(100vh - 160px);
      overflow-y: auto;
    }

    .property {
      font: normal normal bold 24px / 71px Roboto;
      color: #3B3B3B;
    }

    .row {
      margin-right: -15px;
      margin-left: -15px;
      width: 98%;
    }

    .row div {
      padding: 1vh;
    }

    label {
      display: inline-block;
    }

    /* .form-control {
      display: block;
      width: 100%;
      height: 34px;
      padding: 6px 12px;
      font-size: 14px;
      line-height: 1.42857143;
      color: #555;
      background-color: #fff;
      border: 1px solid #ccc;
      border-radius: 4px;
    } */
.document-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}

.document-table th,
.document-table td {
  border: 1px solid #050505;
  padding: 8px;
  font-size: 14px;
}

.document-table th {
  background: #c9c9df;
  text-align: center;
  font-weight: bold;
}

.sub-doc {
  margin-left: 20px;
  font-size: 13px;
}

.center {
  text-align: center;
  font-weight: bold;
}


.container { padding: 20px 30px; }
.section { margin-bottom: 30px; }
.section-title {
  font-size: 18px;
  font-weight: bold;
  margin-bottom: 10px;
  border-bottom: 1px solid #000;
  padding-bottom: 5px;
}
.details { width: 100%; border-collapse: collapse; }
.details td {
  padding: 8px 10px;
  vertical-align: top;
}
.label { font-weight: bold; width: 30%; }
.value { width: 20%; }
.box {
  border: 1px solid #000;
  padding: 10px;
  margin-top: 5px;
  background: #e1e0e7;
}
.action-buttons {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin: 30px 0;
}
/* ================= ARV SECTION ================= */

.arv-section{
  margin-top:40px;
}

.main-title{
  font-size:28px;
  font-weight:600;
  border-bottom:1px solid #d6c4c4;
  padding-bottom:10px;
}

.note-box{
  margin-top:20px;
  font-size:16px;
  width:65%;
  margin-left:auto;
  margin-right:auto;
}

.factor-list{
  margin-top:15px;
  font-size:16px;
  width:65%;
  margin-left:auto;
  margin-right:auto;
}

.factor-list li{
  margin-bottom:10px;
}

.sub-title{
  font-size:24px;
  font-weight:600;
  margin-top:35px;
  border-bottom:1px solid #ccc;
  padding-bottom:8px;
}

.arv-table{
  width:100%;
  margin-top:20px;
  border-collapse:collapse;
  font-size:16px;
}

.arv-table th,
.arv-table td{
  border:1px solid #999;
  padding:10px;
  text-align:center;
}

.arv-table th{
  background:#afaabb;
  font-weight:bold;
}
/* Reusing existing ARV table styles */

.tax-section{
  margin-top:35px;
}



.btn {
  padding: 10px 25px;
  font-size: 16px;
  font-weight: bold;
  border: none;
  cursor: pointer;
  color: #fff;
  border-radius: 4px;
}

.btn-pay {
  background-color: #28a745; /* green */
}

.btn-pay:hover {
  background-color: #218838;
}

.btn-back {
  background-color: #007bff; /* blue */
  text-decoration: none;
  display: inline-block;
  line-height: 22px;
}

.btn-back:hover {
  background-color: #0056b3;
}
/* arv */


.main-title{
    font-size:28px;
    font-weight:600;
    border-bottom:1px solid #131212;
    padding-bottom:10px;
    margin-top:15px;
}

.note-box{
    margin-top:20px;
    margin-left:30%;
    font-size:17px;
}

.factor-list{
    list-style:disc;
    margin-top:15px;
    margin-left:30%;
    font-size:18px;
}

.factor-list li{margin-bottom:12px;}

.sub-title{
    font-size:26px;
    font-weight:600;
    margin-top:40px;
    border-bottom:1px solid #ddd;
    padding-bottom:8px;
}

.table{
    margin-top:20px;
    font-size:17px;
}

.table th,.table td{text-align:center;}


.tax-section{
  margin-top:35px;
}

.tax-detail-table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}

.tax-detail-table td{
  padding:8px 10px;
  vertical-align:middle;
}

.tax-detail-table .label{
  width:25%;
  text-align:left;
}

.tax-detail-table .value{
  width:25%;
  text-align:center;
  font-weight:600;
}

.gap-row td{
  height:15px;
}

.tax-calc-title{
  margin-top:30px;
}




.footer { margin-top: 40px; padding: 10px; text-align: right; font-size: 13px; border-top: 1px solid #000; }
</style>
</head>
<body>

<!-- HEADER -->
<!-- HEADER -->
  <div class="header">
    <div class="container-fluid">
      <div class="row align-items-center">
        <div class="col-8 col-md-4">
          <img id="imgLogo" src="Images/Group12060.png" alt="logo">
        </div>
        <div class="col-4 d-md-none text-end"></div>
      </div>
    </div>
  </div>
<!-- FORM CONTENT -->
  <div id="dvContent">
    <form id="propertyForm" enctype="multipart/form-data">
      <div class="formBody">

<div class="container">

  <!-- Section 1: Basic Information -->
  <div class="section">
    <div class="section-title">Basic Information</div>
    <table class="details">
      <tr>
        <td class="label">SAS No.:</td><td class="value" id="appNoLabel"></td>
        <td class="label">Circle:</td><td class="value" id="circleLabel"></td>
      </tr>
      <tr>
        <td class="label">Ward:</td><td class="value" id="wardLabel"></td>
        <td class="label">Property Type:</td><td class="value" id="propertyTypeLabel"></td>
      </tr>
      <tr>
        <td class="label">Year of Assessment:</td><td class="value" id="assessmentYearLabel"></td>
        <td class="label">Ownership Type:</td><td class="value" id="otypeLabel"></td>
      </tr>
    </table>
  </div>

  <!-- Section 2: Address Details -->
  <div class="section">
    <div class="section-title">Address Details</div>
    <table class="details">
      <tr>
        <td class="label">Property Address:</td><td class="value" id="propertyAddressLabel"></td>
        <td class="label">Property Pin:</td><td class="value" id="propertyPinLabel"></td>
      </tr>
      <tr>
        <td class="label">Correspondence Address:</td><td class="value" id="correspondenceAddressLabel"></td>
        <td class="label">Correspondence Pin:</td><td class="value" id="correspondencePinLabel"></td>
      </tr>
    </table>
  </div>

  <!-- Section 3: Property Details -->
  <div class="section">
    <div class="section-title">Property Details</div>
    <table class="details">
      <tr>
        <td class="label">Road on which Located:</td><td class="value" id="roadLabel"></td>
        <td class="label">Road Category:</td><td class="value" id="roadCategoryLabel"></td>
      </tr>
      <tr>
        <td class="label">Plot Area (Sq. Ft.):</td><td class="value" id="plotAreaLabel"></td>
        <td class="label">Built-up Area (Sq. Ft.):</td><td class="value" id="builtUpAreaLabel"></td>
      </tr>
      <tr>
        <td class="label">Rain Water Harvesting:</td><td class="value" id="rainWaterLabel"></td>
        <td class="label">Acquisition Date:</td><td class="value" id="acquisitionDateLabel"></td>
      </tr>
      <tr>
        <td class="label">Water Connection:</td><td class="value" id="waterConnectionLabel"></td>
        <td class="label">Water Tax Type:</td><td class="value" id="waterTaxTypeLabel"></td>
      </tr>
    </table>
  </div>

  <!-- Section 4: Ownership Details -->
  <div class="section">
    <div class="section-title">Ownership Details</div>
    <table class="details">
      <tr>
        <td class="label">Mobile No:</td><td class="value" id="mobileLabel"></td>
        <td class="label">Email:</td><td class="value" id="emailLabel"></td>
      </tr>
      <tr>
        <td class="label">Owners:</td>
        <td class="value" colspan="3">
          <div class="box" id="ownersLabel"></div>
        </td>
      </tr>
    </table>
  </div>


<!-- Section 4: Ownership Details
  <div class="section">
    <div class="section-title">Ownership Details</div>
    <table class="details">
      <tr>
        <td class="label">Mobile No:</td><td class="value" id="mobileLabel"></td>
        <td class="label">Email:</td><td class="value" id="emailLabel"></td>
      </tr>
      <tr>
        <td class="label">Owners:</td>
        <td class="value" colspan="3">
          <div class="box" id="ownersLabel"></div>
        </td>
      </tr>
    </table>
  </div> -->

<!-- Owner Details -->
<div class="section">
  <div class="section-title">Owner Details</div>

  <div style="margin:10px 0;">
    <b>Ownership Type:</b>
    <label id="ownershipTypeLabel"></label>
  </div>

  <table class="details document-table">
    <thead>
      <tr>
        <th>Gender</th>
        <th>Single Owner Name</th>
        <th>Guardian Name</th>
        <th>Relation</th>
        <th>Aadhar No.</th>
        <th>Electricity CA No.</th>
        <th>Aadhar/Voter Card</th>
      </tr>
    </thead>

    <tbody id="ownerTableBody">
      <!-- backend se data yahin aayega -->
    </tbody>
  </table>
</div>


<!-- Section 5: Documents -->
  <div class="section">
    <div class="section-title">Documents</div>
    <div class="section">
  <table class="details document-table">
    <tr>
      <th style="width:80%">Document Name</th>
      <th style="width:20%">Uploaded File</th>
    </tr>

    <tr>
      <td>
        <b>1. Registry Paper or CO Rent Receipt and Mutation Order Sheet</b>
        <div class="sub-doc">1. Registry Paper</div>
        <div class="sub-doc">2. CO Rent Receipt and Mutation Order Sheet</div>
      </td>
      <td class="center">
        <label id="registryStatus">Yes</label>
      </td>
    </tr>

    <tr>
      <td>
        <b>2. Electricity Bill</b>
        <div class="sub-doc">1. Electricity Bill</div>
      </td>
      <td class="center">
        <label id="electricityStatus">Yes</label>
      </td>
    </tr>

    <tr>
      <td>
        <b>3. Building / Vacant Land Photo</b>
        <div class="sub-doc">
          (Clearly mentioned GPS location and should be captured at site location)
        </div>
        <div class="sub-doc">1. Building Photo</div>
      </td>
      <td class="center">
        <label id="buildingStatus">Yes</label>
      </td>
    </tr>
  </table>
</div>

  
  </div>

</div>

  <!-- Section 5: Documents -->
  <!-- <div class="section">
    <div class="section-title">Documents</div>
    <table class="details">
      <tr>
        <td class="label">Documents:</td>
        <td class="value" colspan="3">
          <div class="box" id="documentsLabel"></div>
        </td>
      </tr>
    </table>
  </div>

</div> -->
<!-- ================= ARV & TAX DETAILS ================= -->
<!-- ================= ARV & TAX DETAILS ================= -->
<div class="section arv-section" id="arvSection">

  <!-- TITLE -->
  <div class="main-title" id="arvTitle">
    ARV (Annual Rental Value) &amp; Tax Details
  </div>

  <!-- NOTE -->
  <div class="note-box" id="arvNote">
    <label>
      <b>Note:</b>
      The Annual Rental Value (ARV) is calculated based on the
      <span id="ratableAreaLabel">Ratable Area</span>,
      <span id="occupancyFactorLabel">Occupancy Factor</span>
      and
      <span id="arvFactorLabel">ARV Factor</span>.
    </label>
  </div>

  <!-- FACTORS -->
  <ul class="factor-list" id="factorList">
    <li>
      <label for="occupancyFactorLink">
        <b>Occupancy Factor :</b>
      </label>
      <a href="#" id="occupancyFactorLink">Click here</a>
      <span id="occupancyFactorText">to view occupancy factors</span>
    </li>

    <li>
      <label for="arvFactorLink">
        <b>ARV Factor :</b>
      </label>
      <a href="#" id="arvFactorLink">Click here</a>
      <span id="arvFactorText">to view rental rate</span>
    </li>

    <li>
      <label id="arvFormulaLabel">
        <b>Annual Rental Value (ARV)</b> =
        <span id="formulaRatableArea">Ratable Area</span> ×
        <span id="formulaOccupancyFactor">Occupancy Factor</span> ×
        <span id="formulaArvFactor">ARV Factor</span>
      </label>
    </li>
  </ul>

  <!-- SUB TITLE -->
  <div class="sub-title" id="vacantLandTitle">
    Vacant Land Details
  </div>

  <!-- TABLE -->
  <table class="arv-table" id="arvTable">
    <thead>
      <tr>
        <th><label id="yearHeader">Years</label></th>
        <th><label id="vacantAreaHeader">Taxable Vacant Land Area (Sq. Ft.)</label></th>
        <th><label id="unitRateHeader">Unit Rate (Rs./Sq. Ft.)</label></th>
        <th><label id="annualTaxHeader">Annual Tax (Rs.)</label></th>
      </tr>
    </thead>

    <tbody id="vacantLandTableBody">
</tbody>

  </table>

</div>
<!-- ================= END ARV SECTION ================= -->

<!-- ================= END ARV SECTION ================= -->

<!-- ================= ARREAR TAX DETAILS ================= -->
<div class="section tax-section" id="arrearTaxSection">

  <div class="sub-title">
    <label id="arrearTaxTitle">Arrear Tax Details</label>
  </div>

  <table class="arv-table" id="arrearTaxTable">
    <thead>
      <tr>
        <th><label id="arrearYearHeader">Years</label></th>
        <th><label id="arrearAnnualTaxHeader">Annual Tax (Rs.)</label></th>
        <th><label id="arrearVacantTaxHeader">Vacant Land Tax (Rs.)</label></th>
        <th><label id="arrearInterestHeader">Interest / Penalty (Rs.)</label></th>
        <th><label id="arrearTotalHeader">Total Arrears (Rs.)</label></th>
      </tr>
    </thead>

    <tbody id="arrearTaxTableBody">
</tbody>        

  </table>

</div>
<!-- ================= END ARREAR TAX ================= -->


<!-- ================= CURRENT TAX DETAILS ================= -->
<!-- ================= CURRENT TAX DETAILS ================= -->
<div class="section tax-section">

  <div class="main-title">Current Tax Details</div>

  <table class="tax-detail-table">

    <tr>
      <td class="label">Annual Rental Value</td>
      <td class="value">
        <span id="annualRentalValue" name="annualRentalValue"></span>
      </td>

      <td class="label">Annual Tax</td>
      <td class="value">
        <span id="annualTax" name="annualTax"></span>
      </td>
    </tr>

    <tr class="gap-row"><td colspan="4"></td></tr>

    <tr>
      <td class="label">Other Charges</td>
      <td class="value">
        <span id="otherCharges" name="otherCharges"></span>
      </td>

      <td class="label">Vacant Area Tax</td>
      <td class="value">
        <span id="vacantAreaTax" name="vacantAreaTax"></span>
      </td>
    </tr>

    <tr class="gap-row"><td colspan="4"></td></tr>

    <tr>
      <td class="label">Total Annual Tax</td>
      <td class="value">
        <span id="totalAnnualTax" name="totalAnnualTax"></span>
      </td>

      <td class="label">Rebate</td>
      <td class="value">
        <span id="rebate" name="rebate"></span>
      </td>
    </tr>

    <tr class="gap-row"><td colspan="4"></td></tr>

    <tr>
      <td class="label">Rain Water Rebate</td>
      <td class="value">
        <span id="rainWaterRebate" name="rainWaterRebate"></span>
      </td>

      <td class="label">Penalty</td>
      <td class="value">
        <span id="penalty" name="penalty"></span>
      </td>
    </tr>

    <tr class="gap-row"><td colspan="4"></td></tr>

    <tr>
      <td class="label">SWM Tax</td>
      <td class="value">
        <span id="swmTax" name="swmTax"></span>
      </td>

      <td class="label">Total Payable Tax</td>
      <td class="value">
        <span id="totalPayableTax" name="totalPayableTax"></span>
      </td>
    </tr>

  </table>
</div>

<!-- ================= END CURRENT TAX ================= -->




  
<!-- ================= TAX CALCULATION ================= -->
<div class="section tax-calculation">

  <div class="main-title">Tax Calculation</div>

  <table class="tax-detail-table">

    <tr>
      <td class="label">Total Current Tax</td>
      <td class="value">
        <span id="totalCurrentTax" name="totalCurrentTax"></span>
      </td>

      <td class="label">Total Arrear Tax</td>
      <td class="value">
        <span id="totalArrearTax" name="totalArrearTax"></span>
      </td>
    </tr>

    <tr class="gap-row"><td colspan="4"></td></tr>

    <tr>
      <td class="label">Penalty for Late Submission</td>
      <td class="value">
        <span id="latePenalty" name="latePenalty"></span>
      </td>

      <td class="label">Water Tax</td>
      <td class="value">
        <span id="waterTax" name="waterTax"></span>
      </td>
    </tr>

    <tr class="gap-row"><td colspan="4"></td></tr>

    <tr>
      <td class="label">Total Amount</td>
      <td class="value">
        <span id="totalAmount" name="totalAmount"></span>
      </td>

      <td class="label">Penalty Rebate (OTS)</td>
      <td class="value">
        <span id="penaltyRebate" name="penaltyRebate"></span>
      </td>
    </tr>

    <tr class="gap-row"><td colspan="4"></td></tr>

    <tr>
      <td class="label">Total Payable</td>
      <td class="value">
        <span id="totalPayable" name="totalPayable"></span>
      </td>

      <td class="label">&nbsp;</td>
      <td class="value">&nbsp;</td>
    </tr>

  </table>
</div>



<!-- ACTION BUTTONS -->
<div class="action-buttons">
  <button class="btn btn-pay" onclick="goToPayment(event)">
    Pay Now
  </button>

  <a href="f.html" class="btn btn-back">
    Go Back to Form
  </a>
</div>


<div class="footer">
  Developed & Maintained By PMU (IT), PMC
</div>
      </div>
  
  










<script>
async function loadProperty() {
  try {
    /* ===============================
       1️⃣ FETCH PROPERTY DETAILS
    =============================== */
    const res = await fetch("http://localhost:3000/api/property-details/latest");
    const json = await res.json();
    if (!json.success) {
      alert(json.message || "No property data found");
      return;
    }

    const p = json.data;

    /* ===============================
       2️⃣ BASIC PROPERTY INFO
    =============================== */
    document.getElementById("appNoLabel").innerText = p.Application_No || "";
    document.getElementById("circleLabel").innerText = p.circleName || "";
    document.getElementById("wardLabel").innerText = p.ward || "";
    document.getElementById("propertyTypeLabel").innerText = p.propertyType || "";

    document.getElementById("assessmentYearLabel").innerText =
      (p.assessmentYear || []).join(", ");

    document.getElementById("otypeLabel").innerText = p.ownershipName || "";

    document.getElementById("propertyAddressLabel").innerText = p.propertyAddress || "";
    document.getElementById("propertyPinLabel").innerText = p.propertyPin || "";
    document.getElementById("correspondenceAddressLabel").innerText = p.correspondenceAddress || "";
    document.getElementById("correspondencePinLabel").innerText = p.correspondencePin || "";

    document.getElementById("roadLabel").innerText = p.road_name || "";
    document.getElementById("roadCategoryLabel").innerText = p.roadCategory || "";
    document.getElementById("plotAreaLabel").innerText = p.plotArea || "";
    document.getElementById("builtUpAreaLabel").innerText = p.builtUpArea || "";
    document.getElementById("rainWaterLabel").innerText = p.rainWater || "";
    document.getElementById("acquisitionDateLabel").innerText = p.acquisitionDate || "";
    document.getElementById("waterConnectionLabel").innerText = p.waterConnection || "";
    document.getElementById("waterTaxTypeLabel").innerText = p.waterTaxType || "";

    document.getElementById("mobileLabel").innerText = p.mobile || "";
    document.getElementById("emailLabel").innerText = p.email || "";

    /* ===============================
       3️⃣ OWNERS TABLE
    =============================== */
    const ownerTableBody = document.getElementById("ownerTableBody");
    if (ownerTableBody) {
      ownerTableBody.innerHTML = "";
      (p.owners || []).forEach(o => {
        const tr = document.createElement("tr");
        ["gender","name","guardianName","relation","aadharNo","electricityCANo","identityDocument"]
          .forEach(key => {
            const td = document.createElement("td");
            td.innerText = o[key] || "-";
            tr.appendChild(td);
          });
        ownerTableBody.appendChild(tr);
      });
    }

    /* ===============================
       4️⃣ FETCH BACKEND TAX DATA
    =============================== */
    const encodedAppNo = encodeURIComponent(p.Application_No);
const taxRes = await fetch(`http://localhost:3000/api/vacantlandtax/latest/${encodedAppNo}`);

    const taxJson = await taxRes.json();
    if (!taxJson.success) {
      alert(taxJson.message || "No tax data found");
      return;
    }

    const t = taxJson.data;

    /* ===============================
       5️⃣ VACANT LAND TABLE
    =============================== */
    const tbody = document.getElementById("vacantLandTableBody");
    if (tbody) {
      tbody.innerHTML = "";
      if (t.plotArea > 0) {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${new Date().getFullYear()}</td>
          <td>${t.plotArea}</td>
          <td>${t.ratePerSqFt}</td>
          <td>${t.vacantLandTax.toFixed(2)}</td>
        `;
        tbody.appendChild(tr);
      }
    }

    /* ===============================
       6️⃣ TAX SUMMARY (IMPORTANT)
       Vacant Area Tax = Total Annual Tax
    =============================== */

    // ===== BASIC VALUES =====
    /* ===============================
   6️⃣ TAX SUMMARY (ID MATCHED)
=============================== */

const vacantTax = Number(t.vacantLandTax || 0);
const percentPenalty = Number(t.percentagePenalty || 0);
const fixedPenalty = Number(t.fixedPenalty || 0);
const rebate = Number(t.rebate || 0);

const totalPenalty = percentPenalty + fixedPenalty;
const totalPayable = vacantTax + totalPenalty - rebate;

/* ===== CURRENT TAX DETAILS ===== */
document.getElementById("annualRentalValue").innerText = "₹ 0.00";
document.getElementById("annualTax").innerText = "₹ 0.00";
document.getElementById("otherCharges").innerText = "₹ 0.00";

document.getElementById("vacantAreaTax").innerText =
  "₹ " + vacantTax.toFixed(2);

document.getElementById("totalAnnualTax").innerText =
  "₹ " + vacantTax.toFixed(2);

document.getElementById("rebate").innerText =
  "₹ " + rebate.toFixed(2);

document.getElementById("rainWaterRebate").innerText = "₹ 0.00";

document.getElementById("penalty").innerText =
  "₹ " + totalPenalty.toFixed(2);

document.getElementById("swmTax").innerText = "₹ 0.00";

document.getElementById("totalPayableTax").innerText =
  "₹ " + totalPayable.toFixed(2);

/* ===== TAX CALCULATION ===== */
document.getElementById("totalCurrentTax").innerText =
  "₹ " + vacantTax.toFixed(2);

document.getElementById("totalArrearTax").innerText = "₹ 0.00";

document.getElementById("latePenalty").innerText =
  "₹ " + totalPenalty.toFixed(2);

document.getElementById("waterTax").innerText = "₹ 0.00";

document.getElementById("totalAmount").innerText =
  "₹ " + totalPayable.toFixed(2);

document.getElementById("penaltyRebate").innerText = "₹ 0.00";

document.getElementById("totalPayable").innerText =
  "₹ " + totalPayable.toFixed(2);
  }

 catch (err) {
    console.error(err);
    alert("Error fetching data");
  }
}

window.onload = loadProperty;

function goToPayment(e) {
  e.preventDefault();
  window.location.href = "payment.html";
}
</script>

      </form>


</body>
</html>